<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Workout History</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        body {
          background: linear-gradient(180deg, #ffffff 0%, #f5f7fa 100%);
          min-height: 100vh;
        }

        .page-shell { max-width: 720px; }

        .card-modern {
          background: rgba(255, 255, 255, 0.9);
          backdrop-filter: blur(8px);
          border-radius: 16px;
          padding: 18px;
          box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
        }

        .page-title {
          font-weight: 800;
          letter-spacing: -0.02em;
          margin-bottom: .25rem;
        }

        .page-subtitle {
          color: #6c757d;
          margin-bottom: 1.25rem;
        }

        .workout-card { animation: fadeIn .35s ease; }

        .workout-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: .75rem;
          padding-bottom: .75rem;
          margin-bottom: .75rem;
          border-bottom: 1px solid rgba(0,0,0,0.06);
        }

        .workout-date {
          font-weight: 600;
          display: flex;
          align-items: center;
          gap: .5rem;
        }

        .badge-soft {
          background: rgba(13, 110, 253, 0.10);
          color: #0d6efd;
          border-radius: 999px;
          padding: .35rem .6rem;
          font-weight: 600;
          font-size: .85rem;
          white-space: nowrap;
        }

        .category-list {
          list-style: none;
          padding-left: 0;
          margin: 0;
          display: grid;
          gap: .5rem;
        }

        .category-item {
          padding: .6rem .75rem;
          border-radius: 12px;
          background: rgba(0,0,0,0.03);
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: .75rem;
        }

        .category-item .left {
          display: flex;
          align-items: center;
          gap: .5rem;
          font-weight: 600;
        }

        .actions {
          display: flex;
          gap: .5rem;
          margin-top: 1rem;
        }

        .btn-soft {
          border-radius: 14px;
          padding: .85rem 1rem;
        }

        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(6px); }
          to   { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>

<body>
<div th:replace="fragments/navbar :: navbar"></div>

<div class="container mt-4 page-shell">

    <div class="text-center mb-3">
        <h1 class="page-title">Workout history</h1>
    </div>

    <div class="d-grid gap-3">
        <div th:each="workout : ${workouts}" class="card-modern workout-card">

            <div class="workout-header">
                <div class="workout-date">
                    <i class="bi bi-calendar-event"></i>
                    <span th:text="${#temporals.format(workout.startedAt, 'dd MMM yyyy')}"></span>
                </div>

                <span class="badge-soft"
                      th:text="${#lists.size(workout.workoutExercises)} + ' categories'"></span>
            </div>

            <div class="mb-2 fw-semibold">Categories</div>

            <ul class="category-list" th:if="${workout.workoutExercises != null and #lists.size(workout.workoutExercises) > 0}">
                <li class="category-item" th:each="we : ${workout.workoutExercises}">
                    <div class="left">
                        <i class="bi bi-tag"></i>
                        <span th:text="${we.exercise.category.categoryName}"></span>
                    </div>
                </li>
            </ul>

            <p class="text-muted mb-0" th:if="${workout.workoutExercises == null or #lists.size(workout.workoutExercises) == 0}">
                No exercises recorded for this workout.
            </p>

            <div class="actions">
                <a class="btn btn-outline-primary btn-soft flex-fill d-flex align-items-center justify-content-center gap-2">
                    <i class="bi bi-pencil-square"></i>
                    Update
                </a>

                <form th:action="@{'/history/delete/' + ${workout.id}}" method="post" class="flex-fill">
                    <button type="submit"
                            class="btn btn-outline-danger btn-soft w-100 d-flex align-items-center justify-content-center gap-2"
                            onclick="return confirm('Delete this workout?');">
                        <i class="bi bi-trash"></i>
                        Delete
                    </button>
                </form>
            </div>

        </div>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
